<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopnow</title>
    <link rel="icon" type = "image/x-icon" href="../../../assets/icon/shopping-bag.png">
    <link rel="stylesheet" href="../../../assets/css/product-detail.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdn.jsdelivr.net/npm/geolib/dist/geolib.min.js"></script>
    
</head>
<body>
<header> 
        <div class="logo">
        <img src="../../../assets/icon/shopping-bag.png" alt="shop-detail" width="40px" height="40px">
        <a aria-label="login" href="../../../index.html"><h5 class="logo-name"><b>Shopnow</b></h5></a>
    </div>
    <input type="search" placeholder="search " class="search">
    <i class="fa fa-search" aria-hidden="true"></i>
    <ul class="top-list">
        <li><a aria-label="login" href="../../../pages/sign-in/login.html"><button class="login"><b>Login</b></button></a></li>
        <li><a aria-label="seller" href="../../../pages/Seller/Seller.html"><p class="seller">Seller</p></a></li>
        <li><a aria-label="cart" href="../../../pages/buyer/cart.html"><i class="home-icon fa fa-shopping-cart" aria-hidden="true"></i></a></li>
        <li><a aria-label="pincode" href="../../../pages/buyer/side flow/pincode.html"><i class="home-icon fa-solid fa-location-dot"></i></a></li>

    </ul>
</header>
<main>
    <!-- <a id="edit_link"><button class="pr_btn">EDIT</button></a> -->
    <div class="main-contain">
        <div class="images">
            <!-- this image appended on javascript -->
            <!-- <img  id="img_1" alt="images" width="500px" height="500px"> -->
            <!-- <div class="img-1"> -->
               <!-- <span> <img src="../../../assets/image/redmi-1.webp" alt="image" width="60px" height="130px" class="img-2"></span> -->
                <!-- <span><img src="../../../assets/image/redmi-2.webp" alt="image" class="img-3"></span> -->
               <!-- <span> <img src="../../../assets/image/redmi-3.webp" alt="image" class="img-4"></span> -->
            <!-- </div> -->
        </div>
        <div class="text-box">
        <!-- <div class="rate">
        <h2><b>Redmi Note 11 (Horizon Blue, 128 GB)  (6 GB RAM)</b></h2>
        <p class="price"><b>₹14,690</b></p>
        <div class="rating">
            <div class="rating-1">
                <h5>4.3</h5><i class="fa fa-star" aria-hidden="true"></i>
            </div>
            <p>26,443 Ratings</p></div>
            <div class="free rating-1">
                <h5>Free delivery</h5>
            </div>
        </div> -->
        <div class="option">
            <div class="option-1">
                <p><b>RAM:</b></p>
               <div class="ra ram"> <input type="radio" id="gb" name="64-128"><label for="gb"  name="64-128">4</label></div>
                <div class="ra ram"><input type="radio" id="fb"  name="64-128"><label for="fb"  name="64-128">6</label>
                </div>
            </div>
            <div class="option-2">
                <p><b>Storage:</b></p>
               <div class="ram"> <input type="radio" id="gb" name="lie"><label for="gb"  name="lie">64</label></div>
                <div class="ram"><input type="radio" id="fb"  name="lie"><label for="fb"  name="lie">128</label>
                </div>
            </div>
            <div class="high">
                <p><b>Highlights</b></p>
                <ul class="ul_highlights">
                    <!-- <li>6 GB RAM | 128 GB ROM</li>
                    <li>16.33 cm (6.43 inch) Display</li>
                    <li>50MP Rear Camera</li>
                    <li>5000 mAh Battery</li> -->
                </ul>
            </div>
        </div>
        </div>
    </div>
    
    <div class="shops">
    </div>
    <!-- <h2 class="head">Available shop nearby you</h2> -->

      <footer>
        <ul>
            <li><a aria-label="contact" href="#">contact us</a></li>
            <li><a aria-label="about" href="#">About us</a></li>
            <li><a aria-label="cancel" href="#">Cancellation reports</a></li>
            <li><a aria-label="faq" href="#">FAQ</a></li>
            <li><a aria-label="payment" href="#">Payments</a></li>
        </ul>
        <ul>
            <li><a aria-label="policy" href="#">Return policy</a></li>
            <li><a aria-label="Term" href="#">Term of use</a></li>
            <li><a aria-label="Security" href="#">Security</a></li>
            <li><a aria-label="Privacy" href="#">Privacy</a></li>
            <li><a aria-label="Sitemap" href="#">Sitemap</a></li>
        </ul>
        <div class="social">
            <i class="fa-brands fa-square-facebook"></i>
            <i class="fa-brands fa-instagram"></i>
            <i class="fa-brands fa-youtube"></i>
            <i class="fa-brands fa-square-twitter"></i>
        </div>
        <div class="scroll">
            <a aria-label="Back" href="#"> <button><p><b>Back to top</b></p> <i class="fa-solid fa-angles-up"></i></button></a>
         </div>
    </footer>
</main>
<script>
    //product_detail array with contain page details
//    const product_detail =[
//     {
//         id : "1",
//         images : {
//             main_image :"../../../assets/image/redmi-main.webp",
//             image_1  : "../../../assets/image/redmi-1.webp",
//             image_2 : "../../../assets/image/redmi-2.webp",
//             image_3 : "../../../assets/image/redmi-3.webp"
//         },

//         product_name : "Redmi Note 11 (Horizon Blue, 128 GB) (6 GB RAM)",
//         product_price : "₹14,690",
//         star : "4.3",
//         ratings : "26,443 Ratings",

//         highlights : {
//             lists_1 : "5000 mAh Battery",
//             lists_2 : "50MP Rear Camera",
//             lists_3 : "16.33 cm (6.43 inch) Display",
//             lists_4 : "6 GB RAM | 128 GB ROM",
//         },
//         shop_name : "Chennai - Madipakam",
//         shop_address : "69/70, Bazaar Road, Meenatchi Sundareswarar Koil, Sadasiva Nagar, Madipakkam, Chennai. Tamil Nadu 600091 Ph: 805678889",
//         width : "500px",
//         height : "500px"

//     },
//     {
//         id : "2",
//         images : {
//             main_image :"../../../../assets/image/samsung-galaxy/Resize_samsung-main.webp",
//             image_1  : "../../../../assets/image/samsung-galaxy/samsung-2.webp",
//             image_2 : "../../../../assets/image/samsung-galaxy/samsung-3.webp",
//             image_3 : "../../../../assets/image/samsung-galaxy/samsung-4.webp"
//         },

//         product_name : "SAMSUNG Galaxy S21 FE 5G (Lavender, 128 GB)",
//         product_price : "₹39,999",
//         star : "4.3",
//         ratings : "26,946 Ratings",

//         highlights : {
//             lists_1 : "8 GB RAM | 128 GB ROM",
//             lists_2 : "16.26 cm (6.4 inch) Full HD+ Display",
//             lists_3 : "12MP + 12MP + 8MP (OIS) | 32MP Front Camera",
//             lists_4 : "4500 mAh Lithium-ion Battery",
//         },
//         shop_name : "Chennai - Koyambedu",
//         shop_address : "No: 1, Kaliamman Koil Street, opp KFC Koyambedu, Chennai.Tamil Nadu 600107 Ph: 8428100000",
//         width : "400px",
//         height : "500px"
//     },
//     {
//         id : "3",
//         images : {
//             main_image :"../../../../assets/image/iphone 14/iphone_main.webp",
//             image_1  : "../../../../assets/image/iphone 14/iphone_1.webp",
//             image_2 : "../../../../assets/image/iphone 14/iphone_2.webp",
//             image_3 : "../../../../assets/image/iphone 14/iphone_3.webp"
//         },

//         product_name : "APPLE iPhone 14 (Blue, 128 GB)",
//         product_price : "₹71,999",
//         star : "4.7",
//         ratings : "15,830 Ratings",

//         highlights : {
//             lists_1 : "15.49 cm (6.1 inch) Super Retina XDR Display",
//             lists_2 : "12MP + 12MP | 12MP Front Camera",
//             lists_3 : "A15 Bionic Chip, 6 Core Processor Processor",
//             lists_4 : "128 GB ROM",
//         },
//         shop_name : "Chennai - Koyambedu",
//         shop_address : "No: 1, Kaliamman Koil Street, opp KFC Koyambedu, Chennai.Tamil Nadu 600107 Ph: 8428100000",
//         width : "400px",
//         height : "500px"
//     }


 //  ]

 //get product details array from local storage
 const product_array = JSON.parse(localStorage.getItem("products"))
 //console.log(product_array)

//get url from search bar
const url = window.location.search;
//console.log(url);
const urlParams = new URLSearchParams(url);
//console.log(urlParams);
const params_id = urlParams.get("id")

let split_arr = params_id.split(",")
const productname = split_arr[0]
//console.log(productname);

//console.log(productname);

let user
const search = product_array.find(function (userobj){

    const name = userobj["user_id"]+"";
    //console.log(name);
    user = name
    
    //console.log(name);
    if (productname === name) {
        return true

    } else {

        return false

    }
})

    //create elements those are want to change the content

//<img src="../../../assets/image/redmi-main.webp" alt="images" width="500px" height="500px">


const div_2 = document.createElement("div")
div_2.setAttribute("class","img-1")
document.querySelector(".images").append(div_2)

const main_div_img = document.createElement("div")
main_div_img.setAttribute("class","main_div_img")
document.querySelector(".images").append(main_div_img)

// const main_img = document.getElementById("img_1")
// main_img.setAttribute("src",search["product_img_1"])
// main_img.setAttribute("alt","redmi")
// main_img.setAttribute("width","400px")
// main_img.setAttribute("height", "500px")
// document.querySelector(".main_div_img").append(main_img)


// <span> <img src="../../../assets/image/redmi-1.webp" alt="image" width="60px" height="130px" class="img-2"></span> 
//<span><img src="../../../assets/image/redmi-2.webp" alt="image" class="img-3"></span> 
//<span> <img src="../../../assets/image/redmi-3.webp" alt="image" class="img-4"></span>

const span_1 = document.createElement("span")
span_1.setAttribute("class","span_1")
document.querySelector(".img-1").prepend(span_1)


const span_2 = document.createElement("span")
span_2.setAttribute("class","span_2")
document.querySelector(".img-1").prepend(span_2)


const span_3 = document.createElement("span")
span_3.setAttribute("class","span_3")
document.querySelector(".img-1").prepend(span_3)


const img_1 = document.createElement("img")
img_1.setAttribute("src",search["product_img_2"])
img_1.setAttribute("alt","image")
img_1.setAttribute("width","60px")
img_1.setAttribute("height","130px")
img_1.setAttribute("class","img-2 image")
document.querySelector(".span_3").append(img_1)


const img_2 = document.createElement("img")
img_2.setAttribute("src",search["product_img_3"])
img_2.setAttribute("alt","image")
img_2.setAttribute("class","img-3 image")
document.querySelector(".span_2").append(img_2)


const img_3 = document.createElement("img")
img_3.setAttribute("src",search["product_img_4"])
img_3.setAttribute("alt","image")
img_3.setAttribute("class","img-4 image")
document.querySelector(".span_1").append(img_3)

// <!-- <div class="rate">
//         <h2><b>Redmi Note 11 (Horizon Blue, 128 GB)  (6 GB RAM)</b></h2>
//         <p class="price"><b>₹14,690</b></p>
//         <div class="rating">
//             <div class="rating-1">
//                 <h5>4.3</h5><i class="fa fa-star" aria-hidden="true"></i>
//             </div>
//             <p>26,443 Ratings</p></div>
//             <div class="free rating-1">
//                 <h5>Free delivery</h5>
//             </div>
//         </div> -->
//product details elements created here

//main div contain with price and rating
const div_3 = document.createElement("div")
div_3.setAttribute("class","rate")
document.querySelector(".text-box").prepend(div_3)

//product name
const h2 = document.createElement("h2")
h2.innerHTML = search["product_name"] 
h2.setAttribute("class","higher")
document.querySelector(".rate").append(h2)

//b tag for bold product name
const b_1 = document.createElement("b")
document.querySelector(".higher").append(b_1)

//product price
const p_1 = document.createElement("p")
p_1.setAttribute("class","price")
p_1.innerHTML = search["product_price"] 
document.querySelector(".rate").append(p_1)

//b tag for bold price
const b_2 = document.createElement("b")
document.querySelector(".price").append(b_2)

//div 4tg with contained rating
const div_4 = document.createElement("div")
div_4.setAttribute("class","rating")
document.querySelector(".rate").append(div_4)

//div for show rating
const div_5 = document.createElement("div")
div_5.setAttribute("class","rating-1")
document.querySelector(".rating").append(div_5)

//rating number
const h5 = document.createElement("h5")
h5.innerHTML = "4.7"
document.querySelector(".rating-1").append(h5)

//star icon for indicate rating
const i = document.createElement("i")
i.setAttribute("class","fa fa-star")
i.setAttribute("aria-hidden","true")
document.querySelector(".rating-1").append(i)

//how many peoples rated count
const p_2 = document.createElement("p")
p_2.innerHTML = 2000 + "ratings"
document.querySelector(".rating").append(p_2)

//6th div for show free deliviry
const div_6 = document.createElement("div")
div_6.setAttribute("class","free rating-1")
document.querySelector(".rate").append(div_6)

//free dilivery content
const h5_2 = document.createElement("h5")
h5_2.innerHTML = "Free delivery"
document.querySelector(".free").append(h5_2)

//-------------------------------------------------------------------------------------------------
//<li>6 GB RAM | 128 GB ROM</li>
//<li>16.33 cm (6.43 inch) Display</li>
//<li>50MP Rear Camera</li>
//<li>5000 mAh Battery</li>

//this lists are highlights

//list 1
const list_1 = document.createElement("li")
list_1.innerHTML = search["highlights"] 
document.querySelector(".ul_highlights").prepend(list_1)

//list 2
// const list_2 = document.createElement("li")
// list_2.innerHTML = search.highlights.lists_2
// document.querySelector(".ul_highlights").prepend(list_2)

// //list 3
// const list_3 = document.createElement("li")
// list_3.innerHTML = search.highlights.lists_3
// document.querySelector(".ul_highlights").prepend(list_3)

// //list 4
// const list_4 = document.createElement("li")
// list_4.innerHTML = search.highlights.lists_4
// document.querySelector(".ul_highlights").prepend(list_4)

//-----------------------------------------------------------------------------------------------------
// shop information here


// const h3_shop = document.createElement("h3")
// h3_shop.innerHTML = "Chennai - Madipakam"
// document.querySelector(".visit-content").append(h3_shop)


// const p_shop = document.createElement("p")
// p_shop.innerHTML = search.shop_address
// document.querySelector(".visit-content").append(p_shop)



//get shop array from localstorage
// let shop = JSON.parse(localStorage.getItem("shoper"))
// let shops=" ";
// for(let i = 0;i < shop.length;i++){
//     shops += `<div class="shop-container">
//         <div class="visit-content">
//           <h3>${shop[i]["city"]} - ${shop[i]["district"]}</h3>
//           <p>${shop[i]["full_address"]}</p>
//         </div>
//           <div class="visit">
//             <a href="shop-detail.html?id=${productname},${shop[i]["owner_id"]}"><button id="visit_btn">Visit store</button></a>
//             <img src="../../../assets/icon/icons8-shop-64.png" alt="assets" class="shop-icon">  
//           </div>
//       </div>`

//      let each_shops= document.querySelector(".shops")
//      each_shops.innerHTML=shops

     

// }






let shop_arr = JSON.parse(localStorage.getItem("shop"))
let profile = JSON.parse(localStorage.getItem("profile"))

//find the shop which get from url params
shop_arr.find(function (obj) {
    if (split_arr[1] === obj["id"]+"") {
       let shops = `
        <h2>Sold by</h2>
       <div class="shop-container">
        <div class="visit-content">
          <h3>${obj["name"]}</h3>
          <p>${obj["address"]}</p>
        </div>
          <div class="visit">
            <a href="shop-detail.html?id=${productname},${obj["id"]}"><button id="visit_btn">Visit store</button></a>
            <img src="../../../assets/icon/icons8-shop-64.png" alt="assets" class="shop-icon">  
          </div>
      </div>`

    let each_shops= document.querySelector(".shops")
     each_shops.innerHTML = shops
    }
})

// for(let i = 0; i < shop_arr.length;i++){

//  let lat1 = profile["lat"]
//  let lon1 = profile["lon"]
//  let lat2 = shop_arr[i]["latitude"]
//  let lon2 = shop_arr[i]["longitude"]
// //  console.log(lat1,lon1,lat2,lon2);

// const distanceInMeters = geolib.getDistance(
//   {latitude: lat1, longitude: lon1},
//   {latitude: lat2, longitude: lon2}
// );

// const distanceInKilometers = distanceInMeters / 1000;
// console.log(distanceInKilometers);
// // distanceInKilometers = 2


// if (distanceInKilometers < 2) {




// }
// if (count === 3) {
//     break;
// }
// }


    let main_div_img2 =  document.querySelector(".main_div_img")
    main_div_img.innerHTML = ""
    main_div_img.innerHTML = `<img id="img_1" alt="redmi" width="400px" height="500px" src="https://iili.io/HVTwSyl.webp">
    <div class="buy-btns">
            <a><button class="btn-buy" id="cart"><p><b id="cart_text">Add cart </b><i class="fa-solid fa-cart-shopping"></i></p></button></a>
            <a><button class="btn-buy" id="buy"><p><b>Buy now </b> <i class="fa-solid fa-angles-right"></i></p></button></a>
           </div>`

//this var contain all three images
const photo = document.querySelectorAll(".image")

const main_img = document.getElementById("img_1")
for(let k = 0;k < photo.length;k++){

    //this event for showing img in main img 
    photo[k].addEventListener("mouseenter",function () {
         main_img.src = photo[k].currentSrc       
    })

    //this event for showing the default img in main img
    // photo[k].addEventListener("mouseleave",function () {
    //      main_img.src = search["product_img_1"]    
    // })
}

const search2 = product_array.find(function (userobj){

const name = userobj["user_id"]+"";
//console.log(name);

//console.log(name);
if (split_arr[0] === name) {
    return true

} else {

    return false
}
})

//button elements
const order = document.getElementById("buy")
const cart = document.getElementById("cart")
const cart_text = document.getElementById("cart_text")

const user_array = JSON.parse(localStorage.getItem("profile"))


const cart_arr = JSON.parse(localStorage.getItem("cart"))

let already_in_cart = false

if (cart_arr !== null) {
    cart_arr.find(function (obj) {
        if (user_array["user_id"] === obj["user_id"] && split_arr[0] === obj["product_id"]+"") {
            already_in_cart = true
            cart_text.innerText = "Go to cart"
            cart_text.style.marginRight = "5px"
        }
    })
}
//this function for add to cart
cart.addEventListener("click",function(){

if (user_array === false || user_array === null) {

    window.location.href = "../../sign-in/login.html"
}
else{
    let cart_arr = JSON.parse(localStorage.getItem("cart"))?JSON.parse(localStorage.getItem("cart")):[]

    const quantity = document.getElementById("quantity")

    //creating unique id
    let uid = Math.floor(Math.random() * 1000)
    cart_arr.push(
        {
            "cart_id" : uid,
            "user_id" : user_array["user_id"],
            "product_id" : search2["user_id"],
            "quantity" : "1"
        }
    )

if (already_in_cart == false) {
    localStorage.setItem("cart",JSON.stringify(cart_arr)); 
}

    window.location.href = "../cart.html?user_id="+user_array["user_id"]+","+split_arr[1]
}
})

order.addEventListener("click",function(){

if (user_array === false || user_array === null) {
    window.location.href = "../../sign-in/login.html"

} else {
    const quantity = document.getElementById("quantity")
search2["quantity"] = "1"

localStorage.setItem("products",JSON.stringify(product_array))

window.location.href = "../address.html?id="+split_arr[0]+","+split_arr[1]
}
})
</script>  
</body>
</html>
